<Window x:Class="EngineeringTools.UI.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:EngineeringTools.UI"
        mc:Ignorable="d"
        Title="Engineering Tools - Job Management System" Height="750" Width="1200"
        WindowStartupLocation="CenterScreen">
    
    <!-- Main Container -->
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>  <!-- Menu Bar -->
            <RowDefinition Height="Auto"/>  <!-- Toolbar -->
            <RowDefinition Height="*"/>     <!-- Main Content -->
            <RowDefinition Height="Auto"/>  <!-- Status Bar -->
        </Grid.RowDefinitions>
        
        <!-- Menu Bar -->
        <Menu Grid.Row="0" Background="LightGray">
            <MenuItem Header="_File">
                <MenuItem Header="_New Job" Click="NewJob_Click"/>
                <MenuItem Header="_Open Job" Click="OpenJob_Click"/>
                <Separator/>
                <MenuItem Header="_Database">
                    <MenuItem Header="_Browse Database" Click="BrowseDatabase_Click"/>
                    <MenuItem Header="_Rebuild Index" Click="RebuildIndex_Click"/>
                </MenuItem>
                <Separator/>
                <MenuItem Header="E_xit" Click="Exit_Click"/>
            </MenuItem>
            <MenuItem Header="_Tools">
                <MenuItem Header="_XML File Search" Click="XmlSearch_Click"/>
                <MenuItem Header="_Cutlist Generator" Click="CutlistGenerator_Click"/>
                <MenuItem Header="_Job History" Click="JobHistory_Click"/>
            </MenuItem>
            <MenuItem Header="_Help">
                <MenuItem Header="_About" Click="About_Click"/>
            </MenuItem>
        </Menu>
        
        <!-- Toolbar -->
        <ToolBar Grid.Row="1" Background="LightBlue">
            <Button Content="New Job" Click="NewJob_Click" Padding="10,5" Margin="5"/>
            <Button Content="Load from Excel" Click="LoadFromExcel_Click" Padding="10,5" Margin="5" Background="LightGreen"/>
            <Button Content="Generate Cutlist" Click="GenerateCutlist_Click" Padding="10,5" Margin="5"/>
            <Button Content="Create Burn List" Click="CreateBurnList_Click" Padding="10,5" Margin="5" Background="Orange"/>
            <Separator/>
            <Button Content="Browse Database" Click="BrowseDatabase_Click" Padding="10,5" Margin="5"/>
            <Button Content="Refresh" Click="Refresh_Click" Padding="10,5" Margin="5"/>
        </ToolBar>
        
        <!-- Main Content Area -->
        <TabControl Grid.Row="2" Name="MainTabControl" Margin="5">
            
            <!-- Job Management Tab -->
            <TabItem Header="Job Management">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Job Input Section -->
                    <GroupBox Grid.Row="0" Header="Job Information" Margin="0,0,0,10">
                        <Grid Margin="10">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="200"/>
                                <ColumnDefinition Width="20"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="200"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="120"/>
                                <ColumnDefinition Width="120"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="10"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <Label Grid.Row="0" Grid.Column="0" Content="Job Number:" VerticalAlignment="Center"/>
                            <TextBox Grid.Row="0" Grid.Column="1" Name="JobNumberTextBox" Padding="5" VerticalAlignment="Center"/>
                            
                            <Label Grid.Row="0" Grid.Column="3" Content="Part Number:" VerticalAlignment="Center"/>
                            <TextBox Grid.Row="0" Grid.Column="4" Name="PartNumberTextBox" Padding="5" VerticalAlignment="Center"/>
                            
                            <Button Grid.Row="0" Grid.Column="6" Content="Load Job" Click="LoadJob_Click" Padding="10,5"/>
                            <Button Grid.Row="0" Grid.Column="7" Content="Preview Cutlist" Click="PreviewCutlist_Click" Padding="10,5" Background="LightCyan" Margin="5,0,0,0"/>
                            
                            <Label Grid.Row="2" Grid.Column="0" Content="Description:" VerticalAlignment="Center"/>
                            <TextBox Grid.Row="2" Grid.Column="1" Grid.ColumnSpan="4" Name="JobDescriptionTextBox" Padding="5" VerticalAlignment="Center"/>
                            
                            <Button Grid.Row="2" Grid.Column="6" Grid.ColumnSpan="2" Content="Save Job" Click="SaveJob_Click" Padding="10,5"/>
                        </Grid>
                    </GroupBox>
                    
                    <!-- MRP Data Section -->
                    <GroupBox Grid.Row="1" Header="MRP Data" Margin="0,0,0,10">
                        <DataGrid Name="MrpDataGrid" AutoGenerateColumns="False" Height="150" IsReadOnly="True">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Part Number" Binding="{Binding PartNumber}" Width="150"/>
                                <DataGridTextColumn Header="Revision" Binding="{Binding Revision}" Width="80"/>
                                <DataGridTextColumn Header="Quantity" Binding="{Binding Quantity}" Width="100"/>
                                <DataGridTextColumn Header="Description" Binding="{Binding Description}" Width="*"/>
                                <DataGridTextColumn Header="XML Status" Binding="{Binding XmlStatus}" Width="120"/>
                                <DataGridTextColumn Header="Highest REL" Binding="{Binding HighestRelease}" Width="100"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </GroupBox>
                    
                    <!-- Cutlist Results -->
                    <GroupBox Grid.Row="2" Header="Generated Cutlist">
                        <DataGrid Name="CutlistDataGrid" AutoGenerateColumns="False" IsReadOnly="True">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Component" Binding="{Binding ComponentPartNumber}" Width="150"/>
                                <DataGridTextColumn Header="Description" Binding="{Binding ComponentDescription}" Width="200"/>
                                <DataGridTextColumn Header="Qty" Binding="{Binding TotalQuantity}" Width="60"/>
                                <DataGridTextColumn Header="Material" Binding="{Binding Material}" Width="100"/>
                                <DataGridTextColumn Header="Thickness" Binding="{Binding Thickness}" Width="80"/>
                                <DataGridTextColumn Header="MaxX" Binding="{Binding MaxX}" Width="80"/>
                                <DataGridTextColumn Header="MaxY" Binding="{Binding MaxY}" Width="80"/>
                                <DataGridTextColumn Header="Raw Material" Binding="{Binding RawMaterialNumber}" Width="120"/>
                                <DataGridTextColumn Header="XML Source" Binding="{Binding XmlSource}" Width="*"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </GroupBox>
                </Grid>
            </TabItem>
            
            <!-- Database Browser Tab -->
            <TabItem Header="Database Browser">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                        <Label Content="Search:" VerticalAlignment="Center"/>
                        <TextBox Name="DatabaseSearchTextBox" Width="200" Padding="5" VerticalAlignment="Center"/>
                        <Button Content="Search" Click="DatabaseSearch_Click" Padding="10,5" Margin="5,0"/>
                        <Button Content="Clear" Click="DatabaseClear_Click" Padding="10,5" Margin="5,0"/>
                    </StackPanel>
                    
                    <DataGrid Grid.Row="1" Name="DatabaseResultsDataGrid" AutoGenerateColumns="True" IsReadOnly="True"/>
                </Grid>
            </TabItem>
            
            <!-- XML Analysis Tab -->
            <TabItem Header="XML Analysis">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <GroupBox Grid.Row="0" Header="XML File Analysis" Margin="0,0,0,10">
                        <Grid Margin="10">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="200"/>
                                <ColumnDefinition Width="20"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="120"/>
                            </Grid.ColumnDefinitions>
                            
                            <Label Grid.Column="0" Content="Part Number:" VerticalAlignment="Center"/>
                            <TextBox Grid.Column="1" Name="XmlAnalysisPartTextBox" Padding="5" VerticalAlignment="Center"/>
                            <TextBlock Grid.Column="3" Name="XmlAnalysisStatus" VerticalAlignment="Center" Foreground="Blue"/>
                            <Button Grid.Column="4" Content="Analyze" Click="AnalyzeXml_Click" Padding="10,5"/>
                        </Grid>
                    </GroupBox>
                    
                    <TabControl Grid.Row="1" Name="XmlAnalysisTabControl">
                        <TabItem Header="Components">
                            <DataGrid Name="XmlComponentsDataGrid" AutoGenerateColumns="False" IsReadOnly="True">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Component" Binding="{Binding ComponentPartNumber}" Width="150"/>
                                    <DataGridTextColumn Header="Type" Binding="{Binding ComponentType}" Width="80"/>
                                    <DataGridTextColumn Header="Qty" Binding="{Binding TotalQuantity}" Width="60"/>
                                    <DataGridTextColumn Header="Material" Binding="{Binding Material}" Width="100"/>
                                    <DataGridTextColumn Header="Thickness" Binding="{Binding Thickness}" Width="80"/>
                                    <DataGridTextColumn Header="Level" Binding="{Binding AssemblyLevel}" Width="60"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </TabItem>
                        <TabItem Header="XML Files">
                            <DataGrid Name="XmlFilesDataGrid" AutoGenerateColumns="False" IsReadOnly="True">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Part Number" Binding="{Binding PartNumber}" Width="150"/>
                                    <DataGridTextColumn Header="Revision" Binding="{Binding Revision}" Width="80"/>
                                    <DataGridTextColumn Header="Release" Binding="{Binding Release}" Width="80"/>
                                    <DataGridTextColumn Header="File Name" Binding="{Binding FileName}" Width="200"/>
                                    <DataGridTextColumn Header="Modified" Binding="{Binding FileModifiedDate}" Width="120"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </TabItem>
                    </TabControl>
                </Grid>
            </TabItem>
            
            <!-- Sales Order Check Tab -->
            <TabItem Header="Sales Order Check">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>  <!-- Header -->
                        <RowDefinition Height="Auto"/>  <!-- Input Section -->
                        <RowDefinition Height="Auto"/>  <!-- Status Section -->
                        <RowDefinition Height="10"/>    <!-- Spacer -->
                        <RowDefinition Height="*"/>     <!-- Checked Orders List -->
                        <RowDefinition Height="Auto"/>  <!-- Action Buttons -->
                    </Grid.RowDefinitions>
                    
                    <!-- Header -->
                    <TextBlock Grid.Row="0" Text="Sales Order Verification" FontSize="16" FontWeight="Bold" 
                              HorizontalAlignment="Center" Margin="0,0,0,15"/>
                    
                    <!-- Input Section -->
                    <GroupBox Grid.Row="1" Header="Sales Order Entry" Margin="0,0,0,10">
                        <Grid Margin="10">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="200"/>
                                <ColumnDefinition Width="20"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="10"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <Label Grid.Row="0" Grid.Column="0" Content="Sales Order:" VerticalAlignment="Center"/>
                            <TextBox Grid.Row="0" Grid.Column="1" Name="SalesOrderTextBox" 
                                    VerticalAlignment="Center" Padding="5"/>
                            <Button Grid.Row="0" Grid.Column="3" Name="CheckSalesOrderButton" 
                                   Content="Check Order" Padding="10,5" Margin="5,0" 
                                   Click="CheckSalesOrder_Click" Background="LightBlue"/>
                            <Button Grid.Row="0" Grid.Column="4" Name="AddSalesOrderButton" 
                                   Content="Mark as Checked" Padding="10,5" Margin="5,0" 
                                   Click="AddSalesOrder_Click" Background="LightGreen"/>
                            
                            <TextBlock Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="5" Name="SalesOrderStatusTextBlock" 
                                      Text="Enter a sales order number to check its status" 
                                      Foreground="Gray" FontStyle="Italic"/>
                        </Grid>
                    </GroupBox>
                    
                    <!-- Status Section -->
                    <GroupBox Grid.Row="2" Header="Current Status" Margin="0,0,0,10">
                        <StackPanel Orientation="Horizontal" Margin="10">
                            <TextBlock Text="Excel Database: " FontWeight="Bold"/>
                            <TextBlock Name="ExcelStatusTextBlock" Text="Not Connected" Foreground="Red"/>
                            <TextBlock Text="   |   Total Checked Orders: " FontWeight="Bold" Margin="20,0,0,0"/>
                            <TextBlock Name="CheckedOrderCountTextBlock" Text="0" FontWeight="Bold" Foreground="Blue"/>
                        </StackPanel>
                    </GroupBox>
                    
                    <!-- Action Buttons -->
                    <StackPanel Grid.Row="5" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,10,0,0">
                        <Button Name="ExportCheckedOrdersButton" Content="Export to CSV" 
                               Padding="10,5" Margin="5" Click="ExportCheckedOrders_Click" Background="LightCyan"/>
                        <Button Name="ImportCheckedOrdersButton" Content="Import from CSV" 
                               Padding="10,5" Margin="5" Click="ImportCheckedOrders_Click" Background="LightPink"/>
                        <Button Name="ClearAllOrdersButton" Content="Clear All Orders" 
                               Padding="10,5" Margin="5" Click="ClearAllOrders_Click" Background="LightCoral"/>
                    </StackPanel>
                </Grid>
            </TabItem>
            
            <!-- Programming Check Tab -->
            <TabItem Header="Programming Check">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>  <!-- Header -->
                        <RowDefinition Height="Auto"/>  <!-- Input Section -->
                        <RowDefinition Height="Auto"/>  <!-- Status Section -->
                        <RowDefinition Height="10"/>    <!-- Spacer -->
                        <RowDefinition Height="*"/>     <!-- Missing Programs List -->
                        <RowDefinition Height="Auto"/>  <!-- Action Buttons -->
                    </Grid.RowDefinitions>
                    
                    <!-- Header -->
                    <TextBlock Grid.Row="0" Text="Press Programming Verification" FontSize="16" FontWeight="Bold" 
                              HorizontalAlignment="Center" Margin="0,0,0,15"/>
                    
                    <!-- Input Section -->
                    <GroupBox Grid.Row="1" Header="Part Programming Entry" Margin="0,0,0,10">
                        <Grid Margin="10">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="10"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="20"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="10"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <!-- First Row: Job Number and Part Number inputs -->
                            <Label Grid.Row="0" Grid.Column="0" Content="Job Number:" VerticalAlignment="Center"/>
                            <TextBox Grid.Row="0" Grid.Column="1" Name="ProgramJobTextBox" 
                                    VerticalAlignment="Center" Padding="5"/>
                            
                            <Label Grid.Row="0" Grid.Column="3" Content="Part Number:" VerticalAlignment="Center"/>
                            <TextBox Grid.Row="0" Grid.Column="4" Name="ProgramPartTextBox" 
                                    VerticalAlignment="Center" Padding="5"/>
                            
                            <Button Grid.Row="0" Grid.Column="6" Name="CheckJobProgramsButton" 
                                   Content="Check Job Programs" Padding="10,5" Margin="5,0" 
                                   Click="CheckJobPrograms_Click" Background="Orange"/>
                            <Button Grid.Row="0" Grid.Column="7" Name="CheckProgramButton" 
                                   Content="Check Part" Padding="10,5" Margin="5,0" 
                                   Click="CheckProgram_Click" Background="LightBlue"/>
                            
                            <!-- Second Row: Status and Add Program button -->
                            <TextBlock Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="6" Name="ProgramStatusTextBlock" 
                                      Text="Enter a job number to check all parts, or a part number to check individual programming status" 
                                      Foreground="Gray" FontStyle="Italic"/>
                            <Button Grid.Row="2" Grid.Column="7" Name="AddProgramButton" 
                                   Content="Mark as Programmed" Padding="10,5" Margin="5,0" 
                                   Click="AddProgram_Click" Background="LightGreen"/>
                        </Grid>
                    </GroupBox>
                    
                    <!-- Status Section -->
                    <GroupBox Grid.Row="2" Header="Current Status" Margin="0,0,0,10">
                        <StackPanel Orientation="Horizontal" Margin="10">
                            <TextBlock Text="Press Programs Database: " FontWeight="Bold"/>
                            <TextBlock Name="ProgramExcelStatusTextBlock" Text="Not Connected" Foreground="Red"/>
                            <TextBlock Text="   |   Total Programmed Parts: " FontWeight="Bold" Margin="20,0,0,0"/>
                            <TextBlock Name="ProgrammedPartCountTextBlock" Text="0" FontWeight="Bold" Foreground="Blue"/>
                            <TextBlock Text="   |   150 Press Only" FontWeight="Bold" Margin="20,0,0,0" Foreground="DarkGreen"/>
                        </StackPanel>
                    </GroupBox>
                    
                    <!-- Missing Programs List -->
                    <GroupBox Grid.Row="4" Header="Missing Press Programs">
                        <Grid Margin="5">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            
                            <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,5">
                                <Button Name="RefreshProgramsButton" Content="Refresh List" 
                                       Padding="8,4" Click="RefreshPrograms_Click" Background="LightYellow"/>
                                <TextBlock Text="(Shows parts missing 150 press programs from job searches)" 
                                          VerticalAlignment="Center" Margin="10,0" FontStyle="Italic" Foreground="Gray"/>
                            </StackPanel>
                            
                            <DataGrid Grid.Row="1" Name="MissingProgramsDataGrid" 
                                     AutoGenerateColumns="False" CanUserAddRows="False" 
                                     IsReadOnly="True" SelectionMode="Single"
                                     GridLinesVisibility="Horizontal" AlternatingRowBackground="LightGray">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Part Number" Binding="{Binding PartNumber}" Width="150"/>
                                    <DataGridTextColumn Header="Date Found" Binding="{Binding DateFound}" Width="150"/>
                                    <DataGridTextColumn Header="Job Number" Binding="{Binding JobNumber}" Width="100"/>
                                    <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </GroupBox>
                    
                    <!-- Action Buttons -->
                    <StackPanel Grid.Row="5" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,10,0,0">
                        <Button Name="ExportMissingProgramsButton" Content="Export Missing Parts" 
                               Padding="10,5" Margin="5" Click="ExportMissingPrograms_Click" Background="LightCyan"/>
                        <Button Name="ImportProgrammedPartsButton" Content="Import Programmed Parts" 
                               Padding="10,5" Margin="5" Click="ImportProgrammedParts_Click" Background="LightPink"/>
                        <Button Name="GenerateProgramReportButton" Content="Generate Program Report" 
                               Padding="10,5" Margin="5" Click="GenerateProgramReport_Click" Background="Lavender"/>
                    </StackPanel>
                </Grid>
            </TabItem>
        </TabControl>
        
        <!-- Status Bar -->
        <StatusBar Grid.Row="3" Background="LightGray">
            <StatusBarItem>
                <TextBlock Name="StatusTextBlock" Text="Ready"/>
            </StatusBarItem>
            <StatusBarItem HorizontalAlignment="Right">
                <TextBlock Name="DatabaseStatusTextBlock" Text="Database: Not Connected"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>
